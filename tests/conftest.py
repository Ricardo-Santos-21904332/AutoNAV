"""This file contains the fixtures needed for the tests."""

import os

import pytest
from autonav.file_handlers import readpathfile
from numpy import array, insert


@pytest.fixture(scope="session")
def default_values():
    """This fixture defines the default values to be used in the algorithm tests."""
    ROOT_DIR = os.path.dirname(os.path.realpath(__file__))
    filename = ROOT_DIR + "/path_files/Path_small.txt"
    destinations = readpathfile(filename)
    N = 8  # Number of anchors
    B = 200  # Area border in meters
    K = 50  # Number of measurement samples
    a_i = array(
        [
            [0, 0, 0],
            [0, B, 0],
            [B / 2, 0, 0],
            [B / 2, B, 0],
            [0, 0, B / 8],
            [0, B, B / 8],
            [B / 2, 0, B / 8],
            [B / 2, B, B / 8],
        ]
    ).T
    initial_uav_position = [10, 10, 5]
    return [a_i, N, K, destinations, initial_uav_position]


@pytest.fixture(scope="session")
def ideal_trajectory():
    """This fixture contains the ideal trajectory for the plots.py tests."""
    ROOT_DIR = os.path.dirname(os.path.realpath(__file__))
    filename = ROOT_DIR + "/path_files/Path_small.txt"
    ideal_trajectory = readpathfile(filename)
    ideal_trajectory = insert(ideal_trajectory, 0, [10, 10, 5], axis=0)
    return ideal_trajectory


@pytest.fixture(scope="session")
def seeds():
    """This fixture contains the seeds for the GTRS and WLS tests."""
    return [
        5,
        10,
        20,
    ]


@pytest.fixture(scope="session")
def metrics_trajectories():
    """This fixture contains the trajectories for the metrics.py tests."""
    estimated_trajectory = array(
        [
            [9.99999962, 9.99999996, 4.99999754],
            [11.99410947, 9.84660779, 5.00000705],
            [13.98821739, 9.69321436, 5.00000066],
            [15.98232633, 9.53982188, 5.0000055],
            [17.97643436, 9.38642838, 4.99999871],
            [19.97054325, 9.23303628, 5.00000696],
            [21.96465149, 9.07964328, 5.00000546],
            [23.95875955, 8.92624995, 5.00000067],
            [25.95286755, 8.77285661, 4.9999958],
            [27.94697505, 8.61946163, 4.99997503],
            [29.94108338, 8.46607013, 4.99998826],
        ]
    )
    true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.99410897, 9.846607, 5.00000008],
            [13.98821794, 9.69321398, 4.99999985],
            [15.98232691, 9.53982097, 4.99999983],
            [17.97643588, 9.38642795, 4.99999964],
            [19.97054485, 9.23303494, 4.99999969],
            [21.96465382, 9.0796419, 4.99999944],
            [23.95876279, 8.92624886, 4.99999923],
            [25.95287175, 8.77285584, 4.99999921],
            [27.94698072, 8.61946283, 4.99999938],
            [29.9410897, 8.46606991, 5.00000044],
        ]
    )
    return [estimated_trajectory, true_trajectory]


@pytest.fixture(scope="session")
def expected_trajectories_gtrs_sigma_0():
    """This fixture defines the expected GTRS trajectories for sigma = 0."""
    expected_estimated_trajectory = array(
        [
            [9.99999962, 9.99999996, 4.99999754],
            [11.96116071, 9.60776772, 4.99999721],
            [13.92232185, 9.21553558, 4.99999791],
            [15.88348199, 8.82330229, 4.999986],
            [17.84464418, 8.4310719, 5.00000478],
            [19.80580439, 8.03883851, 4.99999227],
            [21.7669659, 7.64660808, 5.00000907],
            [23.72812616, 7.25437476, 4.99999755],
            [25.68928652, 6.8621417, 4.99998893],
            [27.65044726, 6.4699106, 4.99999824],
            [29.61160763, 6.07767839, 4.99999728],
            [31.57276764, 5.68544437, 4.99998068],
            [33.07008382, 5.38598328, 4.99999949],
            [33.54487575, 5.29102508, 5.00000119],
            [33.81479041, 5.23704155, 4.99999637],
            [33.99385789, 5.20122822, 4.99999784],
            [34.12290389, 5.17541767, 4.99998662],
            [34.24102725, 7.17192767, 5.00000128],
            [34.35915046, 9.16843643, 5.00000358],
            [34.47727341, 11.16494388, 4.99999259],
            [34.59539692, 13.16145365, 5.00000795],
            [34.71352035, 15.15796275, 5.0000136],
            [34.83164322, 17.15447008, 4.99999528],
            [34.89163075, 18.16836999, 4.99999724],
            [34.91648546, 18.58846157, 4.99999418],
            [34.93124667, 18.83795218, 4.9999954],
            [34.9412509, 19.00704167, 4.9999953],
            [34.97057627, 21.0002213, 4.99999274],
            [34.97793246, 21.50016542, 5.00000492],
            [34.98206936, 21.78138256, 4.99998618],
            [34.98480106, 21.96703143, 4.99999182],
            [34.98676396, 22.10042423, 4.99999836],
            [33.41816758, 23.34119101, 4.99999199],
            [31.84957187, 24.58195877, 5.00000204],
            [30.28097588, 25.82272609, 5.00000695],
            [28.71237982, 27.0634932, 5.00001071],
            [27.14378235, 28.30425925, 4.9999971],
            [26.41131343, 28.88364661, 5.00000842],
            [26.09386208, 29.13474974, 4.99998995],
            [25.90316202, 29.28559606, 5.00000505],
        ]
    )
    expected_true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.96116135, 9.60776774, 5.00000019],
            [13.92232271, 9.21553548, 5.00000043],
            [15.88348406, 8.82330321, 5.00000062],
            [17.84464544, 8.43107107, 5.00000206],
            [19.80580677, 8.03883872, 5.00000151],
            [21.76696814, 7.64660653, 5.00000251],
            [23.72812945, 7.25437408, 5.00000117],
            [25.68929081, 6.86214181, 5.00000159],
            [27.6504522, 6.46990974, 5.00000393],
            [29.61161355, 6.07767746, 5.0000044],
            [31.5727749, 5.68544522, 5.00000538],
            [33.07009182, 5.38598275, 5.00001383],
            [33.54488402, 5.2910243, 5.00001395],
            [33.81479892, 5.23704128, 5.00001373],
            [33.9938665, 5.20122782, 5.00001428],
            [34.12291273, 5.1754186, 5.00001456],
            [34.24103613, 7.17192727, 5.00001636],
            [34.35915954, 9.16843593, 5.00001616],
            [34.47728299, 11.1649446, 5.0000155],
            [34.59540654, 13.16145326, 5.00001717],
            [34.71353011, 15.15796192, 5.00001485],
            [34.83165376, 17.15447057, 5.00000925],
            [34.89164151, 18.16837059, 5.00001093],
            [34.91649645, 18.5884625, 5.00001156],
            [34.93125771, 18.83795313, 5.00001259],
            [34.94126201, 19.0070427, 5.00001326],
            [34.97058802, 21.00022293, 5.00001561],
            [34.97794394, 21.50016639, 5.00001742],
            [34.98208159, 21.7813848, 5.0000165],
            [34.98481321, 21.96703345, 5.0000186],
            [34.98677593, 22.1004259, 5.00001966],
            [33.41817897, 23.34119323, 5.00001992],
            [31.84958202, 24.58196058, 5.00002141],
            [30.28098492, 25.82272773, 5.00002094],
            [28.71238766, 27.0634947, 5.00001888],
            [27.14379018, 28.30426137, 5.00001435],
            [26.41132002, 28.88364832, 5.00001534],
            [26.09387005, 29.13475225, 5.00001345],
            [25.90316866, 29.28559798, 5.0000152],
        ]
    )
    return [
        expected_estimated_trajectory,
        expected_true_trajectory,
    ]


@pytest.fixture(scope="session")
def expected_trajectories_gtrs_sigma_1():
    """This fixture defines the expected GTRS trajectories for sigma = 1."""
    expected_estimated_trajectory = array(
        [
            [10.00930112, 10.11974317, 5.03590142],
            [11.97427759, 9.5486463, 4.88177854],
            [13.74242476, 9.25787825, 4.8657601],
            [15.74617403, 8.92943158, 5.10165607],
            [17.93724489, 8.31422023, 5.12123819],
            [19.87344384, 8.08957262, 5.13785152],
            [21.84039295, 7.83703433, 4.81145407],
            [23.60353808, 7.04617318, 5.0219039],
            [25.56340237, 6.91695865, 4.39482172],
            [27.61794754, 6.3300552, 4.8827867],
            [29.67607724, 6.15634883, 4.94099597],
            [31.56651921, 5.56668802, 5.5329315],
            [33.03220414, 5.32138176, 5.23458169],
            [33.49007959, 5.41223583, 5.18051586],
            [33.96550861, 5.20964921, 5.49995868],
            [33.99928719, 5.30510068, 4.62005905],
            [34.14472383, 5.22449482, 4.65731353],
            [34.52814871, 7.33251027, 4.43731015],
            [34.52531579, 9.24079886, 5.21394689],
            [34.35420898, 11.12104198, 4.61242967],
            [34.64330255, 13.29394835, 4.92211525],
            [34.67963484, 15.2617934, 5.47839183],
            [34.7872703, 16.95854208, 4.89680512],
            [35.03895113, 18.40382052, 4.97803748],
            [34.86999202, 18.63847656, 4.32796553],
            [34.86297063, 19.00397162, 5.13788919],
            [34.99160005, 19.02051837, 5.41277957],
            [35.02852289, 21.06072186, 5.07896776],
            [34.79425787, 21.44564048, 4.59764087],
            [35.024751, 21.85638893, 4.81964348],
            [34.87749931, 21.91045237, 4.98639399],
            [35.01482569, 22.22644923, 5.50116526],
            [33.54330252, 23.41634033, 4.39744475],
            [32.05836167, 24.48062534, 4.727215],
            [30.18610851, 25.57766014, 4.99805555],
            [28.75232239, 26.98927392, 5.24075716],
            [27.22820489, 28.37966403, 4.84962141],
            [26.39780993, 29.02200476, 5.12084784],
            [26.02149672, 29.17135781, 4.65347983],
            [26.0373089, 29.26013789, 4.62281133],
        ]
    )
    expected_true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.95930455, 9.59860522, 4.99718528],
            [13.92136138, 9.21100815, 5.00725911],
            [15.88237217, 8.81821899, 5.01964274],
            [17.84195249, 8.41829656, 5.00929657],
            [19.80521174, 8.03695876, 4.99534678],
            [21.76467776, 7.63674125, 4.97748975],
            [23.71956829, 7.21529314, 5.00549869],
            [25.68808752, 6.86185615, 5.00171521],
            [27.64419679, 6.46449041, 5.12716242],
            [29.61226336, 6.10989564, 5.15841167],
            [31.56657961, 5.68542079, 5.18007099],
            [33.07752705, 5.43604243, 4.94554762],
            [33.57135017, 5.35539091, 4.88667877],
            [33.86872113, 5.27420321, 4.85112712],
            [34.01974912, 5.24359599, 4.7781369],
            [34.15897883, 5.20114717, 4.83099829],
            [34.27452387, 7.19726992, 4.87729412],
            [34.34889699, 9.19391774, 4.96598521],
            [34.43703167, 11.19157996, 4.92626166],
            [34.58197663, 13.18442314, 5.01325012],
            [34.68820009, 15.18146561, 5.03644397],
            [34.82243901, 17.16686172, 4.83598895],
            [34.90355907, 18.32665868, 4.87534018],
            [34.8957844, 18.64525725, 4.87972392],
            [34.92054933, 18.90461085, 5.00773828],
            [34.93793188, 19.03095975, 4.99024667],
            [34.94213097, 21.02028213, 4.78390028],
            [34.93521027, 21.49082247, 4.7647398],
            [34.97684014, 21.80533169, 4.84615317],
            [34.9732574, 21.97087083, 4.87226],
            [34.99004761, 22.12020654, 4.87412487],
            [33.41137223, 23.34558116, 4.79512427],
            [31.82965656, 24.56448657, 4.90668196],
            [30.25488224, 25.79590115, 4.96754237],
            [28.73305422, 27.09360649, 4.96811296],
            [27.17506635, 28.3436789, 4.86814907],
            [26.40656784, 28.90252598, 4.92001402],
            [26.10774247, 29.11160289, 4.89417903],
            [25.93406082, 29.25249414, 4.95309669],
        ]
    )
    return [
        expected_estimated_trajectory,
        expected_true_trajectory,
    ]


@pytest.fixture(scope="session")
def expected_trajectories_wls_sigma_0():
    """This fixture defines the expected WLS trajectories for sigma = 0."""
    expected_estimated_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.9611, 9.6077, 5.0],
            [13.9223, 9.2155, 5.0],
            [15.8835, 8.8233, 5.0],
            [17.8446, 8.4311, 5.0],
            [19.8058, 8.0388, 5.0],
            [21.7669, 7.6466, 5.0],
            [23.7281, 7.2544, 4.9999],
            [25.6893, 6.8621, 5.0],
            [27.6504, 6.4699, 4.9999],
            [29.6116, 6.0777, 5.0],
            [31.5727, 5.6854, 5.0],
            [33.0701, 5.386, 5.0],
            [33.5449, 5.291, 5.0],
            [33.8148, 5.2371, 5.0],
            [33.9939, 5.2012, 5.0],
            [34.1229, 5.1754, 5.0],
            [34.241, 7.1719, 5.0],
            [34.3591, 9.1684, 5.0],
            [34.4773, 11.1649, 4.9999],
            [34.5954, 13.1614, 5.0],
            [34.7135, 15.1579, 5.0],
            [34.8316, 17.1545, 4.9999],
            [34.8916, 18.1683, 5.0],
            [34.9165, 18.5885, 5.0],
            [34.9313, 18.8379, 5.0],
            [34.9413, 19.007, 5.0],
            [34.9706, 21.0003, 5.0],
            [34.9779, 21.5002, 5.0],
            [34.9821, 21.7814, 5.0],
            [34.9848, 21.967, 5.0],
            [34.9867, 22.1004, 5.0],
            [33.4182, 23.3412, 5.0],
            [31.8496, 24.5819, 5.0],
            [30.281, 25.8227, 5.0],
            [28.7124, 27.0635, 5.0],
            [27.1438, 28.3042, 5.0],
            [26.4113, 28.8837, 5.0],
            [26.0938, 29.1347, 5.0],
            [25.9032, 29.2856, 5.0],
        ]
    )
    expected_true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.96116135, 9.60776773, 5.0],
            [13.92232401, 9.21554201, 5.0],
            [15.88348608, 8.82331332, 5.0],
            [17.84464743, 8.43108105, 5.0],
            [19.80580834, 8.03884658, 5.0],
            [21.76697069, 7.64661927, 5.0],
            [23.72813261, 7.25438985, 5.0],
            [25.68929329, 6.86215423, 5.0000174],
            [27.65045626, 6.46993007, 5.0000174],
            [29.61161864, 6.07770293, 5.00004408],
            [31.57277859, 5.68546366, 5.00004408],
            [33.07014975, 5.38601564, 5.00004408],
            [33.54493493, 5.29105368, 5.00004408],
            [33.81484011, 5.23707636, 5.00004408],
            [33.99390655, 5.201254, 5.00004408],
            [34.12294149, 5.17544958, 5.00004408],
            [34.24106526, 7.17195823, 5.00004408],
            [34.35919265, 9.16846666, 5.00004408],
            [34.47732497, 11.1649748, 5.00004408],
            [34.59544195, 13.16148385, 5.00006668],
            [34.7135637, 15.15799261, 5.00006668],
            [34.83169419, 17.15450086, 5.00006668],
            [34.89169676, 18.16838051, 5.00010231],
            [34.91655972, 18.58850488, 5.00010231],
            [34.93131801, 18.8379818, 5.00010231],
            [34.94131497, 19.00708608, 5.00010231],
            [34.97061677, 21.00030754, 5.00010231],
            [34.97796646, 21.50021158, 5.00010231],
            [34.98211011, 21.7814171, 5.00010231],
            [34.98483702, 21.96706037, 5.00010231],
            [34.98679993, 22.10046094, 5.00010231],
            [33.41820869, 23.3412355, 5.00010231],
            [31.8496086, 24.58199888, 5.00010231],
            [30.28101557, 25.82277118, 5.00010231],
            [28.71241933, 27.06353942, 5.00010231],
            [27.14381717, 28.30430018, 5.00010231],
            [26.41132741, 28.88371809, 5.00010231],
            [26.09388816, 29.13480393, 5.00010231],
            [25.90320004, 29.2856564, 5.00010231],
        ]
    )
    return [
        expected_estimated_trajectory,
        expected_true_trajectory,
    ]


@pytest.fixture(scope="session")
def expected_trajectories_wls_sigma_1():
    """This fixture defines the expected WLS trajectories for sigma = 1."""
    expected_estimated_trajectory = array(
        [
            [9.8781, 9.9289, 4.9654],
            [12.1664, 9.8263, 5.0604],
            [13.9736, 9.4045, 5.0366],
            [15.8142, 8.9398, 4.7535],
            [17.989, 8.3575, 5.101],
            [19.9147, 8.1106, 4.8798],
            [21.9626, 7.923, 5.2003],
            [23.799, 7.085, 5.3149],
            [25.4814, 6.8426, 4.444],
            [27.6517, 6.3172, 5.0326],
            [29.6721, 6.1442, 4.9502],
            [31.462, 5.5737, 5.0992],
            [33.1871, 5.2876, 5.2029],
            [33.3186, 5.3463, 5.3222],
            [33.9888, 5.1585, 5.1897],
            [34.0393, 5.2874, 4.8749],
            [34.1499, 7.2541, 4.7384],
            [34.4405, 9.3263, 4.7906],
            [34.5078, 11.3262, 5.1962],
            [34.5723, 13.2434, 4.9657],
            [34.6853, 15.2606, 4.8722],
            [34.8628, 17.3057, 5.3533],
            [34.9011, 18.0881, 5.3798],
            [34.902, 18.6367, 4.8843],
            [34.902, 18.8362, 4.3369],
            [34.8265, 19.0981, 4.7899],
            [35.0532, 20.9956, 5.4154],
            [35.0444, 21.4278, 5.2775],
            [34.9495, 21.7507, 4.6063],
            [35.0009, 21.9707, 4.9556],
            [34.9131, 22.0264, 4.783],
            [33.5431, 23.4472, 5.7978],
            [31.9861, 24.7181, 4.5545],
            [30.3682, 25.7137, 4.9284],
            [28.6403, 26.8909, 4.8613],
            [27.2346, 28.1566, 4.9617],
            [26.2853, 28.9337, 5.0178],
            [25.9967, 29.2483, 4.6471],
            [25.9294, 29.5233, 5.2102],
            [25.8861, 29.4116, 5.1005],
        ]
    )
    expected_true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.96258089, 9.61494294, 5.00270303],
            [13.91934112, 9.20134579, 4.99752696],
            [15.87685182, 8.79129671, 4.99411958],
            [17.83581659, 8.38902371, 5.01928845],
            [19.79792992, 8.00175691, 5.00763873],
            [21.75666109, 7.5978651, 5.02324594],
            [23.70799466, 7.16037388, 4.99326664],
            [25.67346967, 6.79451231, 4.93801014],
            [27.63379736, 6.41503426, 5.0525167],
            [29.60240134, 6.06215738, 5.04378319],
            [31.55773581, 5.64223702, 5.06205974],
            [33.14346056, 5.38510579, 5.01759849],
            [33.56195738, 5.3187151, 4.97076028],
            [33.92906293, 5.24310629, 4.9004133],
            [34.06064246, 5.22248193, 4.87572912],
            [34.19095578, 7.21815988, 4.89269821],
            [34.3240241, 9.213308, 4.93364712],
            [34.4286974, 11.21018275, 4.97282244],
            [34.54197744, 13.20646144, 4.92766692],
            [34.66832506, 15.2024408, 4.93779955],
            [34.80078694, 17.1973243, 4.99159246],
            [34.84744912, 18.11366468, 4.87143395],
            [34.87157783, 18.58011238, 4.77877386],
            [34.88838122, 18.81386823, 4.79861216],
            [34.90483337, 19.00924587, 4.90993276],
            [34.98966191, 20.91698344, 5.01265596],
            [34.97604482, 21.43003049, 4.90633],
            [34.9671808, 21.74390438, 4.85092992],
            [34.97545548, 21.94860837, 4.91543962],
            [34.97533957, 22.08116388, 4.92115755],
            [33.41714083, 23.33450073, 4.95526687],
            [31.83454402, 24.54839737, 4.80747558],
            [30.24125532, 25.75301677, 4.90907878],
            [28.67843018, 27.00087217, 4.92992344],
            [27.15825409, 28.29922107, 4.98784406],
            [26.34902939, 28.96677894, 5.00171379],
            [26.08070336, 29.18938537, 4.99799777],
            [25.91907528, 29.31128346, 5.05522517],
            [25.79529512, 29.37477173, 5.02723013],
        ]
    )
    return [
        expected_estimated_trajectory,
        expected_true_trajectory,
    ]
