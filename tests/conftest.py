"""This file contains the fixtures needed for the tests."""

import os

import pytest
from autonav.file_handlers import readpathfile
from numpy import array, insert


@pytest.fixture(scope="session")
def default_values():
    """This fixture defines the default values to be used in the algorithm tests."""
    ROOT_DIR = os.path.dirname(os.path.realpath(__file__))
    filename = ROOT_DIR + "/path_files/Path_small.txt"
    destinations = readpathfile(filename)
    N = 8  # Number of anchors
    B = 200  # Area border in meters
    K = 50  # Number of measurement samples
    a_i = array(
        [
            [0, 0, 0],
            [0, B, 0],
            [B / 2, 0, 0],
            [B / 2, B, 0],
            [0, 0, B / 8],
            [0, B, B / 8],
            [B / 2, 0, B / 8],
            [B / 2, B, B / 8],
        ]
    ).T
    initial_uav_position = [10, 10, 5]
    return [a_i, N, K, destinations, initial_uav_position]


@pytest.fixture(scope="session")
def ideal_trajectory():
    """This fixture contains the ideal trajectory for the plots.py tests."""
    ROOT_DIR = os.path.dirname(os.path.realpath(__file__))
    filename = ROOT_DIR + "/path_files/Path_small.txt"
    ideal_trajectory = readpathfile(filename)
    ideal_trajectory = insert(ideal_trajectory, 0, [10, 10, 5], axis=0)
    return ideal_trajectory


@pytest.fixture(scope="session")
def seeds():
    """This fixture contains the seeds for the GTRS and WLS tests."""
    return [
        5,
        10,
        20,
    ]


@pytest.fixture(scope="session")
def metrics_trajectories():
    """This fixture contains the trajectories for the metrics.py tests."""
    estimated_trajectory = array(
        [
            [9.99999962, 9.99999996, 4.99999754],
            [11.99410947, 9.84660779, 5.00000705],
            [13.98821739, 9.69321436, 5.00000066],
            [15.98232633, 9.53982188, 5.0000055],
            [17.97643436, 9.38642838, 4.99999871],
            [19.97054325, 9.23303628, 5.00000696],
            [21.96465149, 9.07964328, 5.00000546],
            [23.95875955, 8.92624995, 5.00000067],
            [25.95286755, 8.77285661, 4.9999958],
            [27.94697505, 8.61946163, 4.99997503],
            [29.94108338, 8.46607013, 4.99998826],
        ]
    )
    true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.99410897, 9.846607, 5.00000008],
            [13.98821794, 9.69321398, 4.99999985],
            [15.98232691, 9.53982097, 4.99999983],
            [17.97643588, 9.38642795, 4.99999964],
            [19.97054485, 9.23303494, 4.99999969],
            [21.96465382, 9.0796419, 4.99999944],
            [23.95876279, 8.92624886, 4.99999923],
            [25.95287175, 8.77285584, 4.99999921],
            [27.94698072, 8.61946283, 4.99999938],
            [29.9410897, 8.46606991, 5.00000044],
        ]
    )
    return [estimated_trajectory, true_trajectory]


@pytest.fixture(scope="session")
def expected_trajectories_gtrs_sigma_0():
    """This fixture defines the expected GTRS trajectories for sigma = 0."""
    expected_estimated_trajectory = array(
        [
            [9.99999962, 9.99999996, 4.99999754],
            [11.96116071, 9.60776772, 4.99999721],
            [13.92232185, 9.21553558, 4.99999791],
            [15.88348199, 8.82330229, 4.999986],
            [17.84464418, 8.4310719, 5.00000478],
            [19.80580439, 8.03883851, 4.99999227],
            [21.7669659, 7.64660808, 5.00000907],
            [23.72812616, 7.25437476, 4.99999755],
            [25.68928652, 6.8621417, 4.99998893],
            [27.65044726, 6.4699106, 4.99999824],
            [29.61160763, 6.07767839, 4.99999728],
            [31.57276764, 5.68544437, 4.99998068],
            [33.07008382, 5.38598328, 4.99999949],
            [33.54487575, 5.29102508, 5.00000119],
            [33.81479041, 5.23704155, 4.99999637],
            [33.99385789, 5.20122822, 4.99999784],
            [34.12290389, 5.17541767, 4.99998662],
            [34.24102725, 7.17192767, 5.00000128],
            [34.35915046, 9.16843643, 5.00000358],
            [34.47727341, 11.16494388, 4.99999259],
            [34.59539692, 13.16145365, 5.00000795],
            [34.71352035, 15.15796275, 5.0000136],
            [34.83164322, 17.15447008, 4.99999528],
            [34.89163075, 18.16836999, 4.99999724],
            [34.91648546, 18.58846157, 4.99999418],
            [34.93124667, 18.83795218, 4.9999954],
            [34.9412509, 19.00704167, 4.9999953],
            [34.97057627, 21.0002213, 4.99999274],
            [34.97793246, 21.50016542, 5.00000492],
            [34.98206936, 21.78138256, 4.99998618],
            [34.98480106, 21.96703143, 4.99999182],
            [34.98676396, 22.10042423, 4.99999836],
            [33.41816758, 23.34119101, 4.99999199],
            [31.84957187, 24.58195877, 5.00000204],
            [30.28097588, 25.82272609, 5.00000695],
            [28.71237982, 27.0634932, 5.00001071],
            [27.14378235, 28.30425925, 4.9999971],
            [26.41131343, 28.88364661, 5.00000842],
            [26.09386208, 29.13474974, 4.99998995],
            [25.90316202, 29.28559606, 5.00000505],
        ]
    )
    expected_true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.96116135, 9.60776774, 5.00000019],
            [13.92232271, 9.21553548, 5.00000043],
            [15.88348406, 8.82330321, 5.00000062],
            [17.84464544, 8.43107107, 5.00000206],
            [19.80580677, 8.03883872, 5.00000151],
            [21.76696814, 7.64660653, 5.00000251],
            [23.72812945, 7.25437408, 5.00000117],
            [25.68929081, 6.86214181, 5.00000159],
            [27.6504522, 6.46990974, 5.00000393],
            [29.61161355, 6.07767746, 5.0000044],
            [31.5727749, 5.68544522, 5.00000538],
            [33.07009182, 5.38598275, 5.00001383],
            [33.54488402, 5.2910243, 5.00001395],
            [33.81479892, 5.23704128, 5.00001373],
            [33.9938665, 5.20122782, 5.00001428],
            [34.12291273, 5.1754186, 5.00001456],
            [34.24103613, 7.17192727, 5.00001636],
            [34.35915954, 9.16843593, 5.00001616],
            [34.47728299, 11.1649446, 5.0000155],
            [34.59540654, 13.16145326, 5.00001717],
            [34.71353011, 15.15796192, 5.00001485],
            [34.83165376, 17.15447057, 5.00000925],
            [34.89164151, 18.16837059, 5.00001093],
            [34.91649645, 18.5884625, 5.00001156],
            [34.93125771, 18.83795313, 5.00001259],
            [34.94126201, 19.0070427, 5.00001326],
            [34.97058802, 21.00022293, 5.00001561],
            [34.97794394, 21.50016639, 5.00001742],
            [34.98208159, 21.7813848, 5.0000165],
            [34.98481321, 21.96703345, 5.0000186],
            [34.98677593, 22.1004259, 5.00001966],
            [33.41817897, 23.34119323, 5.00001992],
            [31.84958202, 24.58196058, 5.00002141],
            [30.28098492, 25.82272773, 5.00002094],
            [28.71238766, 27.0634947, 5.00001888],
            [27.14379018, 28.30426137, 5.00001435],
            [26.41132002, 28.88364832, 5.00001534],
            [26.09387005, 29.13475225, 5.00001345],
            [25.90316866, 29.28559798, 5.0000152],
        ]
    )
    return [
        expected_estimated_trajectory,
        expected_true_trajectory,
    ]


@pytest.fixture(scope="session")
def expected_trajectories_gtrs_sigma_1():
    """This fixture defines the expected GTRS trajectories for sigma = 1."""
    expected_estimated_trajectory = array(
        [
            [10.00930112, 10.11974317, 5.03590142],
            [11.97427759, 9.5486463, 4.88177854],
            [13.74242476, 9.25787825, 4.8657601],
            [15.74617403, 8.92943158, 5.10165607],
            [17.93724489, 8.31422023, 5.12123819],
            [19.87344384, 8.08957262, 5.13785152],
            [21.84039295, 7.83703433, 4.81145407],
            [23.60353808, 7.04617318, 5.0219039],
            [25.56340237, 6.91695865, 4.39482172],
            [27.61794754, 6.3300552, 4.8827867],
            [29.67607724, 6.15634883, 4.94099597],
            [31.56651921, 5.56668802, 5.5329315],
            [33.03220414, 5.32138176, 5.23458169],
            [33.49007959, 5.41223583, 5.18051586],
            [33.96550861, 5.20964921, 5.49995868],
            [33.99928719, 5.30510068, 4.62005905],
            [34.14472383, 5.22449482, 4.65731353],
            [34.52814871, 7.33251027, 4.43731015],
            [34.52531579, 9.24079886, 5.21394689],
            [34.35420898, 11.12104198, 4.61242967],
            [34.64330255, 13.29394835, 4.92211525],
            [34.67963484, 15.2617934, 5.47839183],
            [34.7872703, 16.95854208, 4.89680512],
            [35.03895113, 18.40382052, 4.97803748],
            [34.86999202, 18.63847656, 4.32796553],
            [34.86297063, 19.00397162, 5.13788919],
            [34.99160005, 19.02051837, 5.41277957],
            [35.02852289, 21.06072186, 5.07896776],
            [34.79425787, 21.44564048, 4.59764087],
            [35.024751, 21.85638893, 4.81964348],
            [34.87749931, 21.91045237, 4.98639399],
            [35.01482569, 22.22644923, 5.50116526],
            [33.54330252, 23.41634033, 4.39744475],
            [32.05836167, 24.48062534, 4.727215],
            [30.18610851, 25.57766014, 4.99805555],
            [28.75232239, 26.98927392, 5.24075716],
            [27.22820489, 28.37966403, 4.84962141],
            [26.39780993, 29.02200476, 5.12084784],
            [26.02149672, 29.17135781, 4.65347983],
            [26.0373089, 29.26013789, 4.62281133],
        ]
    )
    expected_true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.95930455, 9.59860522, 4.99718528],
            [13.92136138, 9.21100815, 5.00725911],
            [15.88237217, 8.81821899, 5.01964274],
            [17.84195249, 8.41829656, 5.00929657],
            [19.80521174, 8.03695876, 4.99534678],
            [21.76467776, 7.63674125, 4.97748975],
            [23.71956829, 7.21529314, 5.00549869],
            [25.68808752, 6.86185615, 5.00171521],
            [27.64419679, 6.46449041, 5.12716242],
            [29.61226336, 6.10989564, 5.15841167],
            [31.56657961, 5.68542079, 5.18007099],
            [33.07752705, 5.43604243, 4.94554762],
            [33.57135017, 5.35539091, 4.88667877],
            [33.86872113, 5.27420321, 4.85112712],
            [34.01974912, 5.24359599, 4.7781369],
            [34.15897883, 5.20114717, 4.83099829],
            [34.27452387, 7.19726992, 4.87729412],
            [34.34889699, 9.19391774, 4.96598521],
            [34.43703167, 11.19157996, 4.92626166],
            [34.58197663, 13.18442314, 5.01325012],
            [34.68820009, 15.18146561, 5.03644397],
            [34.82243901, 17.16686172, 4.83598895],
            [34.90355907, 18.32665868, 4.87534018],
            [34.8957844, 18.64525725, 4.87972392],
            [34.92054933, 18.90461085, 5.00773828],
            [34.93793188, 19.03095975, 4.99024667],
            [34.94213097, 21.02028213, 4.78390028],
            [34.93521027, 21.49082247, 4.7647398],
            [34.97684014, 21.80533169, 4.84615317],
            [34.9732574, 21.97087083, 4.87226],
            [34.99004761, 22.12020654, 4.87412487],
            [33.41137223, 23.34558116, 4.79512427],
            [31.82965656, 24.56448657, 4.90668196],
            [30.25488224, 25.79590115, 4.96754237],
            [28.73305422, 27.09360649, 4.96811296],
            [27.17506635, 28.3436789, 4.86814907],
            [26.40656784, 28.90252598, 4.92001402],
            [26.10774247, 29.11160289, 4.89417903],
            [25.93406082, 29.25249414, 4.95309669],
        ]
    )
    return [
        expected_estimated_trajectory,
        expected_true_trajectory,
    ]


@pytest.fixture(scope="session")
def expected_trajectories_wls_sigma_0():
    """This fixture defines the expected WLS trajectories for sigma = 0."""
    expected_estimated_trajectory = array(
        [
            [9.9999993, 10.00000109, 4.99999943],
            [11.96116316, 9.60776585, 5.00000031],
            [13.92232536, 9.21553041, 4.99999993],
            [15.88348289, 8.82330771, 5.00000033],
            [17.84464656, 8.43106974, 4.99999986],
            [19.80580699, 8.03883968, 5.00000003],
            [21.76696972, 7.64660347, 4.99999918],
            [23.72812877, 7.25437229, 5.00000093],
            [25.68929142, 6.86214174, 5.00000041],
            [27.65044994, 6.46991467, 4.99999985],
            [29.61161333, 6.07767902, 4.99999987],
            [31.57277388, 5.68544103, 4.99999721],
            [33.07008457, 5.38598472, 4.99999882],
            [33.54487718, 5.29102171, 4.99999784],
            [33.81479378, 5.23703923, 5.00000207],
            [33.99385909, 5.20122596, 4.99999965],
            [34.12290567, 5.17541956, 5.00000294],
            [34.24102646, 7.17192759, 4.99999685],
            [34.35915042, 9.16843815, 4.99999879],
            [34.47727556, 11.16494445, 4.99999886],
            [34.59539688, 13.16145251, 5.00000458],
            [34.71352153, 15.15796388, 5.00000118],
            [34.83164341, 17.15446896, 4.99999527],
            [34.89163101, 18.16837283, 5.0000007],
            [34.91648725, 18.58846698, 5.00000278],
            [34.93124724, 18.83795181, 4.99999907],
            [34.94125149, 19.00704171, 4.99999993],
            [34.97057596, 21.0002213, 4.9999994],
            [34.97793449, 21.50016373, 5.00000118],
            [34.98207042, 21.78138554, 5.00000319],
            [34.98480139, 21.9670341, 5.00000346],
            [34.98676447, 22.10042249, 4.99999742],
            [33.41816909, 23.34119118, 5.00000026],
            [31.84957226, 24.58196036, 5.00000489],
            [30.28097505, 25.82272056, 4.99999352],
            [28.71237773, 27.06349025, 5.00000038],
            [27.14378088, 28.30426345, 5.00000566],
            [26.41131268, 28.88364585, 4.99999563],
            [26.09386474, 29.13474867, 4.99999371],
            [25.90316088, 29.28559745, 4.99999777],
        ]
    )
    expected_true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.96116134, 9.60776766, 5.00000004],
            [13.92232271, 9.21553551, 5.00000002],
            [15.88348415, 8.82330365, 5.00000003],
            [17.84464541, 8.43107095, 4.99999999],
            [19.80580678, 8.03883879, 5.00000001],
            [21.76696811, 7.64660638, 5.0],
            [23.72812953, 7.25437448, 5.00000012],
            [25.68929095, 6.86214254, 4.99999996],
            [27.6504523, 6.46991026, 4.99999988],
            [29.61161341, 6.0776768, 4.99999992],
            [31.57277465, 5.68544393, 4.99999996],
            [33.07008594, 5.38598351, 5.00000118],
            [33.54487785, 5.29102472, 5.00000148],
            [33.8147921, 5.2370424, 5.00000188],
            [33.99385862, 5.2012294, 5.00000156],
            [34.12290449, 5.17542051, 5.00000161],
            [34.24102766, 7.1719292, 5.00000121],
            [34.35915119, 9.16843786, 5.0000017],
            [34.47727467, 11.16494652, 5.00000192],
            [34.59539774, 13.16145521, 5.00000218],
            [34.71352131, 15.15796387, 5.00000085],
            [34.8316445, 17.15447255, 5.00000036],
            [34.89163221, 18.16837336, 5.00000204],
            [34.91648704, 18.58846397, 5.00000188],
            [34.93124794, 18.83795267, 5.00000139],
            [34.94125215, 19.00704234, 5.00000153],
            [34.97057787, 21.00022253, 5.00000156],
            [34.97793386, 21.50016599, 5.00000171],
            [34.98207114, 21.78138502, 5.00000149],
            [34.9848026, 21.96703276, 5.000001],
            [34.98676526, 22.10042452, 5.00000056],
            [33.41816841, 23.34119198, 5.00000096],
            [31.84957134, 24.58195918, 5.00000091],
            [30.28097402, 25.82272606, 4.99999979],
            [28.71237766, 27.06349415, 5.00000172],
            [27.14378113, 28.30426202, 5.00000156],
            [26.41131247, 28.88364673, 4.99999962],
            [26.09386269, 29.13475082, 5.00000061],
            [25.90316046, 29.28559704, 5.0000017],
        ]
    )
    return [
        expected_estimated_trajectory,
        expected_true_trajectory,
    ]


@pytest.fixture(scope="session")
def expected_trajectories_wls_sigma_1():
    """This fixture defines the expected WLS trajectories for sigma = 1."""
    expected_estimated_trajectory = array(
        [
            [9.87812496, 9.92895157, 4.96540873],
            [12.16639072, 9.82629471, 5.06045671],
            [13.97359468, 9.40455521, 5.03657107],
            [15.81419381, 8.93980961, 4.75356868],
            [17.98899862, 8.357457, 5.10099446],
            [19.91476928, 8.11062077, 4.87979959],
            [21.96263039, 7.92297938, 5.20035499],
            [23.79903678, 7.08501524, 5.31488801],
            [25.48148071, 6.84257415, 4.44400163],
            [27.65176735, 6.31723497, 5.03265911],
            [29.6721506, 6.14421913, 4.95021045],
            [31.46201073, 5.57365651, 5.09923336],
            [33.18712495, 5.28757351, 5.20288718],
            [33.31863624, 5.34629264, 5.32224115],
            [33.98882531, 5.15855285, 5.18977173],
            [34.03932364, 5.28745283, 4.87495324],
            [34.14986126, 7.25416091, 4.7384604],
            [34.4405237, 9.32632131, 4.79057342],
            [34.50778937, 11.32621471, 5.19626954],
            [34.57228177, 13.24340279, 4.96575131],
            [34.68530338, 15.26067503, 4.87222593],
            [34.86280252, 17.30569696, 5.35326092],
            [34.90110227, 18.08818124, 5.37982307],
            [34.90203147, 18.63666913, 4.88429575],
            [34.90200376, 18.83621564, 4.33686344],
            [34.82650399, 19.09811513, 4.78994632],
            [35.05318254, 20.99555683, 5.41536298],
            [35.04439442, 21.42781035, 5.27756517],
            [34.94952139, 21.75071025, 4.60629065],
            [35.00092421, 21.97067307, 4.95564864],
            [34.91312215, 22.02645994, 4.78299255],
            [33.54304577, 23.44719773, 5.79778808],
            [31.98612578, 24.71811987, 4.55451148],
            [30.36817672, 25.7137465, 4.92835186],
            [28.64027514, 26.89090364, 4.86128539],
            [27.23458211, 28.15659795, 4.9616845],
            [26.28533618, 28.93373204, 5.01778609],
            [25.99669434, 29.24831418, 4.64707753],
            [25.92935538, 29.52329048, 5.21019051],
            [25.88611992, 29.41161555, 5.10057845],
        ]
    )
    expected_true_trajectory = array(
        [
            [10.0, 10.0, 5.0],
            [11.96258006, 9.61493869, 5.00270235],
            [13.9193404, 9.20134214, 4.99752142],
            [15.8768501, 8.79128824, 4.99411674],
            [17.83581478, 8.3890144, 5.01927859],
            [19.79792906, 8.0017524, 5.0076295],
            [21.75665934, 7.59785622, 5.02323683],
            [23.70799322, 7.160367, 4.99324922],
            [25.67346759, 6.79450168, 4.93799466],
            [27.63379564, 6.41502566, 5.05250188],
            [29.60239736, 6.06213659, 5.04375246],
            [31.5577296, 5.6422057, 5.06202534],
            [33.14344219, 5.38509515, 5.01754934],
            [33.56192645, 5.31871165, 4.97071485],
            [33.92901804, 5.24310569, 4.90036005],
            [34.06059384, 5.22247452, 4.87566662],
            [34.19090444, 7.21815271, 4.89262854],
            [34.32397944, 9.21330057, 4.93356819],
            [34.42864852, 11.21017545, 4.97274856],
            [34.54193117, 13.20645363, 4.92757698],
            [34.66828422, 15.20243273, 4.93769445],
            [34.80074678, 17.19731645, 4.9914773],
            [34.84740806, 18.11365713, 4.87133218],
            [34.87153529, 18.58006703, 4.77867003],
            [34.88833364, 18.81383308, 4.79850947],
            [34.90478521, 19.00920871, 4.90983656],
            [34.98961141, 20.91693023, 5.01253665],
            [34.97599856, 21.42999692, 4.90621839],
            [34.96713565, 21.74386893, 4.85080527],
            [34.97540677, 21.94857003, 4.91531611],
            [34.97528775, 22.08113221, 4.92102791],
            [33.41708306, 23.33446162, 4.95513846],
            [31.83449007, 24.54836345, 4.8073488],
            [30.24119694, 25.75297722, 4.90894929],
            [28.67836796, 27.00082757, 4.9298081],
            [27.15819564, 28.29918059, 4.98773507],
            [26.34898085, 28.96673637, 5.00161036],
            [26.0806461, 29.18933708, 4.99789722],
            [25.91901975, 29.31123227, 5.05512798],
            [25.79524977, 29.37471963, 5.02713517],
        ]
    )
    return [
        expected_estimated_trajectory,
        expected_true_trajectory,
    ]
